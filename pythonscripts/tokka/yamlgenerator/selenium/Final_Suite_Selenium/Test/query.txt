Select NARBTF.* from ADVENTISTHEALTHSYSTEM_CDH5.RC_F_NON_AR_BALANCE_TRANSACTION NARBTF inner JOIN(Select account_id, MAX(activity_date) as latestactivitydate from ADVENTISTHEALTHSYSTEM_CDH5.RC_F_NON_AR_BALANCE_TRANSACTION GROUP BY account_id,account_number HAVING account_number LIKE '%SP1234%') NARBT ON NARBT.account_id = NARBTF.account_id AND NARBTF.activity_date = NARBT.latestactivitydate